<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
      <title>Productor - WAVAULT</title>
        <link rel="stylesheet" href="../assets/css/style.css"/>
          <script>
              const usuarioActivo = JSON.parse(localStorage.getItem('usuarioActivo'));
                  if (!usuarioActivo || usuarioActivo.rol !== 'productor') {
                        alert('Acceso denegado. Inicia sesi√≥n como productor.');
                              window.location.href = '../login.html';
                                  }
                                    </script>
                                    </head>
                                    <body>
                                      <header>
                                          <h1>üéß WAVAULT - Productor</h1>
                                              <nav>
                                                    <a href="#" data-seccion="feed">Feed</a>
                                                          <a href="#" data-seccion="misBeats">Mis Beats</a>
                                                                <a href="#" data-seccion="subir">Subir Beat</a>
                                                                      <a href="#" data-seccion="perfil">Mi Perfil</a>
                                                                            <a href="#" onclick="cerrarSesion()">Cerrar Sesi√≥n</a>
                                                                                </nav>
                                                                                  </header>
                                                                                  
                                                                                    <main>
                                                                                        <!-- FEED -->
                                                                                            <section id="feedSection" class="productor-section">
                                                                                                  <div class="search-bar">
                                                                                                          <input type="text" id="buscarBeatsProductor" placeholder="Buscar beats..." />
                                                                                                                </div>
                                                                                                                      <div id="beatsProductor" class="beat-feed"></div>
                                                                                                                          </section>
                                                                                                                          
                                                                                                                              <!-- MIS BEATS -->
                                                                                                                                  <section id="misBeatsSection" class="productor-section" style="display:none;">
                                                                                                                                        <h2>üéµ Mis Beats</h2>
                                                                                                                                              <div id="misBeatsList" class="beat-feed"></div>
                                                                                                                                                  </section>
                                                                                                                                                  
                                                                                                                                                      <!-- SUBIR BEAT -->
                                                                                                                                                          <section id="subirSection" class="productor-section" style="display:none;">
                                                                                                                                                                <h2>üì§ Subir Nuevo Beat</h2>
                                                                                                                                                                      <form id="formSubirBeat" class="upload-form" enctype="multipart/form-data">
                                                                                                                                                                              <input type="text" id="tituloBeat" placeholder="T√≠tulo del Beat" required />
                                                                                                                                                                                      <input type="number" id="precioBeat" placeholder="Precio en $" required />
                                                                                                                                                                                              <input type="text" id="tag1" placeholder="#tag1" required />
                                                                                                                                                                                                      <input type="text" id="tag2" placeholder="#tag2" required />
                                                                                                                                                                                                              <input type="text" id="tag3" placeholder="#tag3" required />
                                                                                                                                                                                                                      <input type="number" id="bpm" placeholder="BPM (Ej: 90)" required />
                                                                                                                                                                                                                              <select id="key" required>
                                                                                                                                                                                                                                        <option value="">Selecciona la clave (Key)</option>
                                                                                                                                                                                                                                                  <option value="C Maj">C Maj</option><option value="C Min">C Min</option>
                                                                                                                                                                                                                                                            <option value="C# Maj">C# Maj</option><option value="C# Min">C# Min</option>
                                                                                                                                                                                                                                                                      <option value="D Maj">D Maj</option><option value="D Min">D Min</option>
                                                                                                                                                                                                                                                                                <option value="D# Maj">D# Maj</option><option value="D# Min">D# Min</option>
                                                                                                                                                                                                                                                                                          <option value="E Maj">E Maj</option><option value="E Min">E Min</option>
                                                                                                                                                                                                                                                                                                    <option value="F Maj">F Maj</option><option value="F Min">F Min</option>
                                                                                                                                                                                                                                                                                                              <option value="F# Maj">F# Maj</option><option value="F# Min">F# Min</option>
                                                                                                                                                                                                                                                                                                                        <option value="G Maj">G Maj</option><option value="G Min">G Min</option>
                                                                                                                                                                                                                                                                                                                                  <option value="G# Maj">G# Maj</option><option value="G# Min">G# Min</option>
                                                                                                                                                                                                                                                                                                                                            <option value="A Maj">A Maj</option><option value="A Min">A Min</option>
                                                                                                                                                                                                                                                                                                                                                      <option value="A# Maj">A# Maj</option><option value="A# Min">A# Min</option>
                                                                                                                                                                                                                                                                                                                                                                <option value="B Maj">B Maj</option><option value="B Min">B Min</option>
                                                                                                                                                                                                                                                                                                                                                                        </select>
                                                                                                                                                                                                                                                                                                                                                                                <label for="archivoPortada" id="labelPortada" class="custom-label">üñºÔ∏è Portada del Beat</label>
                                                                                                                                                                                                                                                                                                                                                                                        <input type="file" name="cover" id="archivoPortada" accept="image/*" required />
                                                                                                                                                                                                                                                                                                                                                                                                <label for="archivoAudio" id="labelAudio" class="custom-label">üéß Archivo de Audio</label>
                                                                                                                                                                                                                                                                                                                                                                                                        <input type="file" name="audio" id="archivoAudio" accept="audio/mp3,audio/wav" required />
                                                                                                                                                                                                                                                                                                                                                                                                                <button type="submit">Subir</button>
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- ‚úÖ Barra de Progreso -->
                                                                                                                                                                                                                                                                                                                                                                                                                                <div id="barraProgresoContainer" style="display:none; margin-top:10px;">
                                                                                                                                                                                                                                                                                                                                                                                                                                          <label for="barraProgreso">Subiendo... <span id="progresoTexto">0%</span></label>
                                                                                                                                                                                                                                                                                                                                                                                                                                                    <progress id="barraProgreso" value="0" max="100" style="width:100%;"></progress>
                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </form>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </section>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <!-- PERFIL -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <section id="perfilSection" class="productor-section" style="display:none;">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <h2>üë§ Mi Perfil</h2>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <p><strong>Email:</strong> <span id="productorEmail">-</span></p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <h3>üìà Historial de Ventas</h3>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <p>Total de ventas registradas: <strong><span id="ventasTotales">0</span></strong></p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <table id="tablaVentasBeats" class="ventas-table">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <thead>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <th>Portada</th>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <th>T√≠tulo del Beat</th>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <th>Ventas</th>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <th>Compradores</th>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </thead>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <tbody></tbody>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </table>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </section>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </main>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <!-- üéß Reproductor Global actualizado con tiempo -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <div id="reproductorGlobal" class="player-bar" style="display: none;">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <div class="player-info">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <img id="playerCover" src="" alt="Cover">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <h4 id="playerTitle">T√≠tulo del Beat</h4>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <p id="playerProducer">Productor</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <div class="player-controls">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <button id="btnPrev" title="Anterior">‚óÄ‚óÄ</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <button id="playPauseBtn" title="Reproducir / Pausar">‚èµ</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <button id="btnNext" title="Siguiente">‚ñ∂‚ñ∂</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <input type="range" id="progressBar" value="0" step="1">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span id="currentTime">0:00</span> / <span id="totalDuration">0:00</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <input type="range" id="volumeControl" min="0" max="1" step="0.01" value="1">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <audio id="audioPlayer"></audio>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <!-- MODAL -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <div id="modalConfirmacion" class="modal" style="display:none;">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <div class="modal-contenido">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <p id="mensajeModal"></p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <button onclick="cerrarModal()">Cerrar</button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <!-- SCRIPT MAIN -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      document.addEventListener("DOMContentLoaded", function () {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const usuario = JSON.parse(localStorage.getItem('usuarioActivo'));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  if (usuario) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          document.getElementById("productorEmail").textContent = usuario.email;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      document.querySelectorAll("a[data-seccion]").forEach(link => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              link.addEventListener("click", function (e) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        e.preventDefault();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  const seccion = this.dataset.seccion;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (typeof mostrarSeccion === 'function') {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        mostrarSeccion(seccion);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      document.getElementById("archivoPortada").addEventListener("change", function () {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              document.getElementById("labelPortada").textContent = this.files[0]?.name || "üñºÔ∏è Portada del Beat";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          document.getElementById("archivoAudio").addEventListener("change", function () {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  document.getElementById("labelAudio").textContent = this.files[0]?.name || "üéß Archivo de Audio";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                function cerrarSesion() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      localStorage.removeItem('usuarioActivo');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            window.location.href = '../login.html';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    function mostrarModal(mensaje) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          document.getElementById("mensajeModal").textContent = mensaje;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                document.getElementById("modalConfirmacion").style.display = "flex";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        function cerrarModal() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              document.getElementById("modalConfirmacion").style.display = "none";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <!-- ‚úÖ SCRIPT PRINCIPAL -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <script src="../assets/js/producer.js"></script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </html>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        >